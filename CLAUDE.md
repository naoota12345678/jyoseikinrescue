# Claude開発メモ

## 重要な注意事項 ⚠️

### 絶対にやってはいけないこと
1. **勝手にファイルを全面的に書き換えない**
   - ユーザーが明確に依頼していない限り、既存のファイルの構造を大幅に変更しない
   - 特に動作している機能を「改善」しようとして壊さない

2. **要求されていない機能追加・変更をしない**
   - ユーザーの具体的な指示のみに従う
   - 「より良くしよう」という判断で勝手な変更をしない

3. **動作しているシステムを触らない**
   - 「問題ない部分」は絶対に変更しない
   - 小さな修正でも影響範囲を慎重に考える

### 正しいアプローチ
1. **最小限の変更のみ**
   - 要求された部分のみを正確に修正
   - 他の部分には一切触らない

2. **変更前に確認**
   - 既存のコードがなぜそうなっているかを理解してから修正
   - 動作している理由を壊さない

3. **段階的な修正**
   - 一度に多くを変更せず、一つずつ確認しながら進める

## セッション完了履歴

### 2025-08-30 ランディングページ完成セッション ✅
**要求内容**: 
- ランディングページとして無料診断が主役のデザインに変更
- 一番下に3つのプランを表示
- 無料診断ボタンが一番目立つように
- ログインや会員登録のクリックした後のUIはそのまま

**実装完了内容**:
1. `auth_index.html`を完全なランディングページに変更
   - 大きな無料診断CTAボタン追加（アニメーション付き）
   - 3段階料金プラン表示（Light ¥1,480、Regular ¥3,300、Heavy ¥5,500）
   - モダンなグラスモーフィズムデザイン・グラデーション背景
   - ログインフォームは隠し、セカンダリボタンで表示
   - 複数箇所に無料診断ボタン配置

2. `dashboard.html`で完了していたエージェント名表示修正
   - `saveAgentConversation`関数にエージェント名マッピング追加
   - "undefined専門エージェント" 問題解決

3. Git管理・デプロイ完了
   - 全変更をコミット・プッシュ
   - ライブ環境に反映済み

**技術ポイント**:
- AUTH_ENABLED=Falseの場合は`auth_index.html`がメインページとして表示
- 既存のログイン機能を保持しつつランディングページ化
- レスポンシブデザイン対応

## 過去の失敗例
- 2025-08-30: index.htmlを無料診断ページからモダンなランディングページに勝手に変更
  - 結果：自動ログイン機能、チャット機能、その他多数の機能が破損
  - 原因：「今すぐ無料診断をスタート」ボタンとロゴ変更だけが要求だったのに全面書き換え

## 環境変数・設定
- ANTHROPIC_API_KEY: Claude APIキー（モックモード対応）
- SECRET_KEY: Flask セッション用
- Firebase認証設定済み
- Stripe決済設定済み

## プロジェクト構造メモ
- `/templates/index.html`: トップページ（無料診断メイン）
- `/templates/dashboard.html`: ログイン後ダッシュボード
- `/templates/subsidy_memo.html`: メモ管理機能
- `/src/app.py`: メインアプリケーション
- `/src/claude_service.py`: Claude API統合